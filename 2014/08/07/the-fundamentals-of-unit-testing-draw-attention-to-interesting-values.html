<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>The fundamentals of unit testing: draw attention to ‘interesting’ values - Mark’s Devblog</title>
<meta name="description" content="This post is part of a series on unit testing.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_GB">
<meta property="og:site_name" content="Mark's Devblog">
<meta property="og:title" content="The fundamentals of unit testing: draw attention to ‘interesting’ values">
<meta property="og:url" content="https://marksimpson82.github.io/blog/2014/08/07/the-fundamentals-of-unit-testing-draw-attention-to-interesting-values.html">


  <meta property="og:description" content="This post is part of a series on unit testing.">







  <meta property="article:published_time" content="2014-08-07T21:51:25+00:00">





  

  


<link rel="canonical" href="https://marksimpson82.github.io/blog/2014/08/07/the-fundamentals-of-unit-testing-draw-attention-to-interesting-values.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Mark's Devblog",
      "url": "https://marksimpson82.github.io/blog/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Mark's Devblog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blog/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/blog/">
          Mark's Devblog
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name"></h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="The fundamentals of unit testing: draw attention to ‘interesting’ values">
    <meta itemprop="description" content="This post is part of a series on unit testing.">
    <meta itemprop="datePublished" content="2014-08-07T21:51:25+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">The fundamentals of unit testing: draw attention to ‘interesting’ values
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>This post is <a href="/blog/2012/10/24/the-fundamentals-of-automated-testing-series.html">part of a series</a> on unit testing.</p>

<p>3 is the magic number? No. No, it’s not.</p>

<p>Magic numbers/strings/other values in all walks of programming are a readability and maintenance liability. It’s quite common to see all kinds of literals being littered through test code. It’s quite easy to simply switch off and treat test code as a second class citizen.</p>

<p>To illustrate this point, please tell me what this does</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Test</span><span class="p">]</span>  
<span class="k">public</span> <span class="k">void</span> <span class="nf">TestInvalidFuelAmount</span><span class="p">()</span>  
<span class="p">{</span>  
 <span class="c1">// Arrange  </span>
 <span class="kt">var</span> <span class="n">car</span> <span class="p">=</span> <span class="nf">CreateLittleCar</span><span class="p">();</span> 

 <span class="c1">// Act &amp; Assert  </span>
 <span class="kt">var</span> <span class="n">exception</span> <span class="p">=</span> <span class="n">Assert</span><span class="p">.</span><span class="n">Throws</span><span class="p">&lt;</span><span class="n">ArgumentException</span><span class="p">&gt;(</span>
   <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">car</span><span class="p">.</span><span class="nf">AddFuel</span><span class="p">(</span><span class="m">500</span><span class="p">));</span>  
<span class="p">}</span>
</code></pre></div></div>

<p>It’s not exactly crystal clear, is it? Although the naming of this test can and should be improved, bear in mind that it’s an extremely simple case (one method call with one argument being passed). Despite this, the intent is still obscured because of a literal.</p>

<p><a name="Replace_magic_values_with_named_consts"></a></p>

<h2 id="replace-literals-with-named-consts">Replace literals with named consts</h2>

<p>Let’s change 500 to a named constant. Let’s also change the test name while we’re at it.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Test</span><span class="p">]</span>  
<span class="k">public</span> <span class="k">void</span> <span class="nf">when_the_car_fuel_tank_capacity_is_too_low_and_fuel_is_added_an_exception_is_thrown</span><span class="p">()</span>  
<span class="p">{</span>  
 <span class="c1">// Arrange  </span>
 <span class="kt">var</span> <span class="n">car</span> <span class="p">=</span> <span class="nf">CreateLittleCar</span><span class="p">();</span>  
 <span class="k">const</span> <span class="kt">int</span> <span class="n">LitresOfFuelThatIsTooLargeForTankCapacity</span> <span class="p">=</span> <span class="m">500</span><span class="p">;</span> 

 <span class="c1">// Act &amp; Assert  </span>
 <span class="kt">var</span> <span class="n">exception</span> <span class="p">=</span> <span class="n">Assert</span><span class="p">.</span><span class="n">Throws</span><span class="p">&lt;</span><span class="n">ArgumentException</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span>  
 <span class="n">car</span><span class="p">.</span><span class="nf">AddFuel</span><span class="p">(</span><span class="n">LitresOfFuelThatIsTooMuchForTankCapacity</span><span class="p">));</span>  
<span class="p">}</span>
</code></pre></div></div>

<p>Now that’s much clearer. We can see what the value represents, the units it’s measured in and its place in the test. Some people shit the bed when they see really long story-like variable names in tests, but they’re generally a help, not a hindrance.</p>

<p>While the previous example is simple, this tip makes much more of a difference in situations where a function/method/constructor has numerous parameters, but the test is largely focused on only one of them. How do you know which one to pay attention to?</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Test</span><span class="p">]</span>  
<span class="k">public</span> <span class="k">void</span> <span class="nf">when_account_balance_is_low_money_transfers_fail_when_would_be_overdrawn</span><span class="p">()</span>  
<span class="p">{</span>  
 <span class="c1">// Arrange  </span>
 <span class="kt">var</span> <span class="n">currentAccount</span> <span class="p">=</span> <span class="nf">GetCurrentAccountWithBalanceInUSD</span><span class="p">(</span><span class="m">10</span><span class="p">);</span> 

 <span class="c1">// Act  </span>
 <span class="kt">bool</span> <span class="n">transferSucceeded</span> <span class="p">=</span> 
   <span class="n">currentAccount</span><span class="p">.</span><span class="nf">TryTransfer</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span> <span class="m">42</span><span class="p">,</span> <span class="m">602402</span><span class="p">);</span> 

 <span class="c1">// Assert  </span>
 <span class="n">Assert</span><span class="p">.</span><span class="nf">That</span><span class="p">(</span><span class="n">transferSucceeded</span><span class="p">,</span> <span class="n">Is</span><span class="p">.</span><span class="n">False</span><span class="p">);</span>  
<span class="p">}</span>
</code></pre></div></div>

<p>Fine, this is a crufty-looking API, but in certain circumstances, it’s quite common to see functions/constructors that take multiple arguments of a similar type. At a glance, how can you tell which of the arguments is the one of interest to the test? Is it 1000, 42 or 602402? What is the significance of any of them? Which one is causing the transfer to fail?</p>

<p>Let’s use a named const to draw attention to the interesting argument.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Test</span><span class="p">]</span>  
<span class="k">public</span> <span class="k">void</span> <span class="nf">when_account_balance_is_low_money_transfers_fail_when_would_be_overdrawn</span><span class="p">()</span>  
<span class="p">{</span>  
 <span class="c1">// Arrange  </span>
 <span class="kt">var</span> <span class="n">currentAccount</span> <span class="p">=</span> <span class="nf">GetCurrentAccountWithBalanceInUSD</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>  
 <span class="k">const</span> <span class="kt">int</span> <span class="n">AmountInUSDThatWillForceAccountIntoOverdraft</span> <span class="p">=</span> <span class="m">1000</span><span class="p">;</span> 

 <span class="c1">// Act  </span>
 <span class="kt">bool</span> <span class="n">transferSucceeded</span> <span class="p">=</span> <span class="n">currentAccount</span><span class="p">.</span><span class="nf">TryTransfer</span><span class="p">(</span>
   <span class="n">AmountInUSDThatWillForceAccountIntoOverdraft</span> <span class="p">,</span> <span class="m">42</span><span class="p">,</span> <span class="m">602402</span><span class="p">);</span> 

 <span class="c1">// Assert  </span>
 <span class="n">Assert</span><span class="p">.</span><span class="nf">That</span><span class="p">(</span><span class="n">transferSucceeded</span><span class="p">,</span> <span class="n">Is</span><span class="p">.</span><span class="n">False</span><span class="p">);</span>  
<span class="p">}</span>
</code></pre></div></div>

<p>Turns out the 42 is the number of cents in the transfer, and that 602402 is just a dummy customer number we’re passing through.</p>

<p>We can go further than this to clean things up still further by doing things such as:</p>

<ul>
  <li>Extract a wrapper test method that calls TryTransfer, but only has one parameter: the amount of USD to withdraw (the other parameters can be satisfied with constants). This draws attention to the important part of the test (varying the value of the USD transfer amount) and also helps insulate the tests from changes to the TryTransfer method.</li>
  <li>In the production code, using types that are more appropriate to reduce ambiguity (e.g. in the case of a customer account number, an AccountCredentials class would be more suitable than an int!)</li>
  <li>Finally, if lots of things are changed in the tests, but in slightly different ways each time, consider the use of a <a href="/blog/2009/04/10/the-test-data-builder-pattern-with-c-30.html">Test Data Builder</a>. Test data builders are very useful, as the provided defaults are sensible for most cases. As a result, when arranging your test, the only things that are changed in the builder are the things that actually matter. Test data builders can also insulate the tests from breaking changes.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/blog/tags/fundamentals-of-unit-testing" class="page__taxonomy-item" rel="tag">fundamentals of unit testing</a><span class="sep">, </span>
    
      
      
      <a href="/blog/tags/testing" class="page__taxonomy-item" rel="tag">testing</a><span class="sep">, </span>
    
      
      
      <a href="/blog/tags/tips" class="page__taxonomy-item" rel="tag">tips</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2014-08-07T21:51:25+00:00">August 7, 2014</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=The+fundamentals+of+unit+testing%3A+draw+attention+to+%27interesting%27+values%20https%3A%2F%2Fmarksimpson82.github.io%2Fblog%2F2014%2F08%2F07%2Fthe-fundamentals-of-unit-testing-draw-attention-to-interesting-values.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmarksimpson82.github.io%2Fblog%2F2014%2F08%2F07%2Fthe-fundamentals-of-unit-testing-draw-attention-to-interesting-values.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fmarksimpson82.github.io%2Fblog%2F2014%2F08%2F07%2Fthe-fundamentals-of-unit-testing-draw-attention-to-interesting-values.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/blog/2014/08/07/the-fundamentals-of-unit-testing-arrange-act-assert.html" class="pagination--pager" title="The fundamentals of unit testing: Arrange, Act, Assert
">Previous</a>
    
    
      <a href="/blog/2014/08/23/crayon-syntax-highlighter.html" class="pagination--pager" title="Crayon syntax highlighter
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2020/08/10/the-fundamentals-of-automated-testing-setup-structure.html" rel="permalink">The fundamentals of unit testing: Setup structure
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">This post is part of a series on unit testing.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2020/08/05/the-fundamentals-of-automated-testing-data-driven-tests.html" rel="permalink">The fundamentals of unit testing: Data-driven tests
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">This post is part of a series on unit testing.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2020/08/02/goodbye-wordpress-hello-jekyll-and-github-pages.html" rel="permalink">Goodbye Wordpress, Hello Jekyll and Github Pages
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  8 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">I’ve been using Wordpress with 34sp.com hosting since the late noughties, and it’s time for a 
change.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2020/03/29/nvidia-g-sync-black-screen-when-alt-tabbing.html" rel="permalink">Nvidia + G-SYNC - Black screen when alt-tabbing
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">tl;dr: It seems G-SYNC related. I fixed it by installing the monitor driver, then toggling G-SYNC on/off.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/blog/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Mark's Devblog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/blog/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
